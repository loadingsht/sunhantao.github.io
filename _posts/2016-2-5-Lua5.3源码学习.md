---
layout: post
comments: true
categories: lua
---
# Lua5.3源码学习

## 目录
1. [阅读方式](#阅读方式)
- [从main开始](#从main开始)
- [C内置类型别名](#C内置类型别名)
- [内部类型](#内部类型)
- [外部类型](#外部类型)
- [内部方法](#内部方法)
- [API](#api)

-------------------------------------------------------
## 阅读方式
- 我实际按照程序执行顺序来进行阅读，深度优先遍历。
- 而文章的顺序是广度优先，可以有一个全面的预览，每一条用连接保证深度阅读。


-------------------------------------------------------
## 从main开始
- 声明一个[lua_State](#lua_state)结构L


-------------------------------------------------------
## C内置类型别名

### lu_byte
unsigned char


-------------------------------------------------------
## 内部类型

### CallInfo
lstate.h 函数调用信息，链表结构，包含了函数基地址，当前PC地址，函数返回值个数。

### GCObject
lobject.h 垃圾收集对象，是一个自嵌套的结构。lua中所有可被垃圾回收的结构均包含它。

### TValuefields
lobject.h lua各种值的实际表现，由一个union＋一个tag表示。


-------------------------------------------------------
## 外部类型

### lua_CFunction
lua.h lua可以调用的C函数形式。

    typedef int (*lua_CFunction) (lua_State *L);
    
### lua_Integer
lua.h 整数，32位机器为4字节，64位机器为8字节

### lua_Number
lua.h 浮点数，32位机器为4字节，64位机器为8字节

### lua_State
lstate.h lua堆栈，每个线程一个，主要包含了一个堆栈及其状态。还包含[global_State](#global_state)指针，[CallInfo](#callinfo)，[GCObject](#gcobject)信息。

### global_State
lstate.h 全局堆栈，所有线程共用一个


-------------------------------------------------------
## 内部方法

### doargs


-------------------------------------------------------
## API
